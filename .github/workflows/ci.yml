      - name: Ruff (syntax gate) -> Reports/ci_ruff.txt
        shell: pwsh
        run: |
          New-Item -ItemType Directory -Force -Path Reports | Out-Null
          if (Test-Path "main_gui.py") {
            ruff check modules main_gui.py --select E9,F63,F7,F82 2>&1 | Tee-Object -FilePath Reports/ci_ruff.txt
          } else {
            ruff check modules --select E9,F63,F7,F82 2>&1 | Tee-Object -FilePath Reports/ci_ruff.txt
          }

      - name: Compileall (syntax gate) -> Reports/ci_compileall.txt
        shell: pwsh
        run: |
          New-Item -ItemType Directory -Force -Path Reports | Out-Null
          if (Test-Path "main_gui.py") {
            python -m compileall -q main_gui.py modules 2>&1 | Tee-Object -FilePath Reports/ci_compileall.txt
          } else {
            python -m compileall -q modules 2>&1 | Tee-Object -FilePath Reports/ci_compileall.txt
          }
